<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5. Design Principles for fundiversity • fundiversity</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="5. Design Principles for fundiversity">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fundiversity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/fundiversity.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/fundiversity_1-parallel.html">2. Parallelize Computation of Indices</a></li>
    <li><a class="dropdown-item" href="../articles/fundiversity_2-performance.html">3. Performance Benchmark with other packages</a></li>
    <li><a class="dropdown-item" href="../articles/fundiversity_3-correctness.html">4. Check Numerical Correctness of Indices</a></li>
    <li><a class="dropdown-item" href="../articles/fundiversity_4-design-principles.html">5. Design Principles for fundiversity</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/funecology/fundiversity/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>5. Design Principles for fundiversity</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/funecology/fundiversity/blob/main/vignettes/fundiversity_4-design-principles.Rmd" class="external-link"><code>vignettes/fundiversity_4-design-principles.Rmd</code></a></small>
      <div class="d-none name"><code>fundiversity_4-design-principles.Rmd</code></div>
    </div>

    
    
<p>This package is built with a clear set of design principles based on
current best practices. These design principles have been established
before writing any code to make sure obstacles along the way would not
lower our expectations.</p>
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<p>fundiversity aims to provide a reliable tool to compute functional
diversity indices. As some of the most used functional diversity indices
are defined in Villéger et al. (2008), fundiversity adopts this
framework. Rao’s Quadratic Entropy is quite popular as an additional
functional diversity index, which makes it a good addition to the panel
of indices computable with fundiversity.</p>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p>We aim at having as few as dependencies as possible, unless they
remain relatively lightweight <strong>and</strong> provide a large speed
boost.</p>
<p>As CRAN packages are now automatically archived at the same time of
any of their strong dependencies, dependencies for fundiversity should
be well established, have a good track record at remaining on CRAN, and
ideally already have a large number of reverse-dependencies.</p>
<p>Based on these guidelines, some acceptable dependencies are:</p>
<ul>
<li><a href="https://cran.r-project.org/package=Rcpp" class="external-link">Rccp</a></li>
<li><a href="https://davidcsterratt.github.io/geometry/" class="external-link">geometry</a></li>
</ul>
<p>Additionally, special care is taken with packages that rely on
external libraries, as <a href="https://twitter.com/groundwalkergmb/status/1350336844022521857" class="external-link">their
installation might be an issue on shared computing platforms where users
don’t have super-user privileges</a>.</p>
<p>fundiversity does however depend on <a href="https://cran.r-project.org/package=vegan" class="external-link">vegan</a> which brings
quite a number of other dependencies. vegan is still heavy developed and
as such shouldn’t be archived by CRAN without notice. fundiversity users
probably already have vegan installed as they are probably also
interested in other community ecology analyses provided by vegan. Thus
depending on vegan is not a dependency nor an installation burden.</p>
</div>
<div class="section level2">
<h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a>
</h2>
<div class="section level3">
<h3 id="each-index-should-be-computed-in-its-own-separate-function">Each index should be computed in its own separate function<a class="anchor" aria-label="anchor" href="#each-index-should-be-computed-in-its-own-separate-function"></a>
</h3>
<p>Putting each index in its own function improves maintainability by
having shorter, more easily readable functions, with less
control-flow.</p>
<p>Additionally, it speeds up computation (versus the case where all
indices would be computed each time) and keep the number of columns in
the output constant (as opposed to the case where an argument would
control which index is returned by a single function with all
indices).</p>
</div>
<div class="section level3">
<h3 id="input-data-should-not-be-transformed-without-any-explicit-action-from-the-user">Input data should not be transformed without any explicit action
from the user<a class="anchor" aria-label="anchor" href="#input-data-should-not-be-transformed-without-any-explicit-action-from-the-user"></a>
</h3>
<p>Some packages in functional ecology transform the data before
processing it. One common such transformation is the use of
dimensionality reduction techniques.</p>
<p>Such transformations should only be done by the user if they wish to
do so but never by the package itself. Even when documented in the
function help, it is easily overlooked by users and may lead to
misinterpreted results.</p>
<p>One acceptable exception is when function need dissimilarity matrix
as input, such as for the computation of FEve or Rao’s Quadratic
Entropy. Because other functions in fundiversity accept raw trait data,
for the sake of coherence the functions that need dissimilarity matrix
as input should also accept raw trait data and compute dissimilarity
internally. To do so, they should still make minimal assumptions
regarding the input dataset that all traits are quantitative. If it’s
not the case, then it’s the user’s responsibility to choose the adapted
dissimilarity metric she wants to use.</p>
</div>
</div>
<div class="section level2">
<h2 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h2>
<p>Two inputs are acceptable in fundiversity functions:</p>
<ul>
<li>tabular data (such as a <code>matrix</code>, or a
<code>tibble</code>, but with a preference for <code>data.frame</code>s)
with individuals as rows and characteristics as columns.</li>
<li>a distance matrix between individuals.</li>
</ul>
<p>The rationale is that providing <code>data.frame</code>s with
characteristics is more user-friendly, as they are a common format in
functional ecology, and <code>data.frame</code>s are a familiar object
in R.</p>
<p>However, only allowing <code>data.frame</code>s doesn’t provide
enough flexibility. In particular, advanced users may want to compute
distances with a custom function (instead of Euclidean distances).</p>
</div>
<div class="section level2">
<h2 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a>
</h2>
<div class="section level3">
<h3 id="functions-should-output-data-frames">Functions should output <code>data.frame</code>s<a class="anchor" aria-label="anchor" href="#functions-should-output-data-frames"></a>
</h3>
<p>The functions should return <code>data.frame</code>s whenever
possible for several reasons:</p>
<ul>
<li>
<code>data.frame</code>s are one of the most common object in the R
ecosystem meaning they are familiar to beginners and there exist many S3
methods for them.</li>
<li>
<code>data.frame</code>s enable a pipe-able workflow, which is
important it is already prevalent in the tidyverse and will be part of
base R 4.1</li>
</ul>
</div>
<div class="section level3">
<h3 id="the-outputs-of-functions-should-be-similar-in-structure">The outputs of functions should be similar in structure<a class="anchor" aria-label="anchor" href="#the-outputs-of-functions-should-be-similar-in-structure"></a>
</h3>
<p>To avoid further steps of data wrangling after running analyses, all
functions should output similar structured data. When computing
functional diversity indices most users want to compute site-level
metric. To make our functions easy to use and flexible, they should only
output the absolutely necessary data:</p>
<ul>
<li>a column named <code>site</code> containing the site names as given
by the user (guessed from the row names in the input site-species
matrix),</li>
<li>a column named following the computed functional index
(<code>FDiv</code>, <code>FRic</code>, etc.) that contains the values of
the indices.</li>
</ul>
<p>That way our functions only outputs unambiguous data that can easily
be reused and merged with other data at the site-level.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://rekyt.github.io/" class="external-link">Matthias Grenié</a>, <a href="https://hugogruson.fr/" class="external-link">Hugo Gruson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
