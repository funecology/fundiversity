<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>4. Check Numerical Correctness of Indices • fundiversity</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="4. Check Numerical Correctness of Indices">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fundiversity</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/fundiversity.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/fundiversity_1-parallel.html">2. Parallelize Computation of Indices</a></li>
    <li><a class="dropdown-item" href="../articles/fundiversity_2-performance.html">3. Performance Benchmark with other packages</a></li>
    <li><a class="dropdown-item" href="../articles/fundiversity_3-correctness.html">4. Check Numerical Correctness of Indices</a></li>
    <li><a class="dropdown-item" href="../articles/fundiversity_4-design-principles.html">5. Design Principles for fundiversity</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/funecology/fundiversity/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>4. Check Numerical Correctness of Indices</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/funecology/fundiversity/blob/main/vignettes/fundiversity_3-correctness.Rmd" class="external-link"><code>vignettes/fundiversity_3-correctness.Rmd</code></a></small>
      <div class="d-none name"><code>fundiversity_3-correctness.Rmd</code></div>
    </div>

    
    
<p>Most research results nowadays rely heavily on results generated by
computational software. Yet, this software, while occupying an
increasingly central place in science, is often poorly tested. Users are
never presented any arguments about why they should trust the code
provided to them.</p>
<p>We want to contribute to change this trend and in this vignette, we
show that indices computed by <code>fundiversity</code> behave as
theoretically expected, and as presented in <span class="citation">Villéger, Mason, and Mouillot (<a href="#ref-Villeger_New_2008">2008</a>)</span>. We also internally
compared <code>fundiversity</code> results with ones obtained by other
packages. You can see the equivalence between functions in the <a href="https://funecology.github.io/fundiversity/articles/fundiversity_2-performance.html#main-functions">benchmark
vignette</a> that compares <code>fundiversity</code> and alternative
packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://funecology.github.io/fundiversity/">fundiversity</a></span><span class="op">)</span></span></code></pre></div>
<p>For this, we reproduce the Figure 2 (including all of their facets)
of their article. If you re-use this figure, please cite the original
article.</p>
<p>We start by reproducing Figure 2 a, to check that the values computed
by <code>fundiversity</code> are correct. These are the data found in
Figure 2 of the article:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>byrow <span class="op">=</span> <span class="cn">TRUE</span>, ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">0.0</span>, <span class="fl">1.0</span>,</span>
<span>    <span class="fl">0.5</span>, <span class="fl">1.0</span>,</span>
<span>    <span class="fl">1.0</span>, <span class="fl">1.0</span>,</span>
<span>    <span class="fl">1.5</span>, <span class="fl">1.0</span>,</span>
<span>    <span class="fl">2.0</span>, <span class="fl">1.0</span>,</span>
<span>    <span class="fl">1.0</span>, <span class="fl">0.0</span>,</span>
<span>    <span class="fl">1.0</span>, <span class="fl">0.5</span>,</span>
<span>    <span class="fl">1.0</span>, <span class="fl">1.5</span>,</span>
<span>    <span class="fl">1.0</span>, <span class="fl">2.0</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1] [,2]</span></span>
<span><span class="co">#&gt; species1  0.0  1.0</span></span>
<span><span class="co">#&gt; species2  0.5  1.0</span></span>
<span><span class="co">#&gt; species3  1.0  1.0</span></span>
<span><span class="co">#&gt; species4  1.5  1.0</span></span>
<span><span class="co">#&gt; species5  2.0  1.0</span></span>
<span><span class="co">#&gt; species6  1.0  0.0</span></span>
<span><span class="co">#&gt; species7  1.0  0.5</span></span>
<span><span class="co">#&gt; species8  1.0  1.5</span></span>
<span><span class="co">#&gt; species9  1.0  2.0</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data_a</span>, pch <span class="op">=</span> <span class="fl">19</span>, asp <span class="op">=</span> <span class="fl">1</span>, xlab <span class="op">=</span> <span class="st">"Trait 1"</span>, ylab <span class="op">=</span> <span class="st">"Trait 2"</span><span class="op">)</span></span></code></pre></div>
<p><img src="fundiversity_3-correctness_files/figure-html/plot-data-a-1.png" width="100%"></p>
<p>We then compute the functional diversity indices.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fric_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span><span class="op">[[</span><span class="st">"FRic"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">feve_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_feve.html">fd_feve</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span><span class="op">[[</span><span class="st">"FEve"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fdiv_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fdiv.html">fd_fdiv</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span><span class="op">[[</span><span class="st">"FDiv"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fdis_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fdis.html">fd_fdis</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span><span class="op">[[</span><span class="st">"FDis"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">raoq_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_raoq.html">fd_raoq</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span><span class="op">[[</span><span class="st">"Q"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>As expected, we found an FRic value of 2 (should be 2), an FEve value
of 1 (should be 1), and a FDiv value of 0.692 (should be 0.692).</p>
<div class="section level2">
<h2 id="changes-of-abundance">Changes of abundance<a class="anchor" aria-label="anchor" href="#changes-of-abundance"></a>
</h2>
<p>If we change the abundance, but not the coordinates (i.e., not the
species characteristics), we expect changes in FEve and FDiv but not
FRic.</p>
<p>More precisely, equal increases in abundance for the species at the
vertices of the convex hull don’t influence FEve, but lead to a higher
FDiv. These correspond to the data found in panel c of the Figure 2.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># common species</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># rare species</span></span>
<span></span>
<span><span class="va">wc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">l</span>, <span class="va">s</span>, <span class="va">l</span>, <span class="va">s</span>, <span class="va">l</span>, <span class="va">l</span>, <span class="va">s</span>, <span class="va">s</span>, <span class="va">l</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">wc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">wc</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"site"</span></span></code></pre></div>
<p>We compute again the functional diversity indices:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fric_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span><span class="op">[[</span><span class="st">"FRic"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">feve_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_feve.html">fd_feve</a></span><span class="op">(</span><span class="va">data_a</span>, <span class="va">wc</span><span class="op">)</span><span class="op">[[</span><span class="st">"FEve"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fdiv_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fdiv.html">fd_fdiv</a></span><span class="op">(</span><span class="va">data_a</span>, <span class="va">wc</span><span class="op">)</span><span class="op">[[</span><span class="st">"FDiv"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fdis_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fdis.html">fd_fdis</a></span><span class="op">(</span><span class="va">data_a</span>, <span class="va">wc</span><span class="op">)</span><span class="op">[[</span><span class="st">"FDis"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">raoq_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_raoq.html">fd_raoq</a></span><span class="op">(</span><span class="va">data_a</span>, <span class="va">wc</span><span class="op">)</span><span class="op">[[</span><span class="st">"Q"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>As expected, we found an FRic value of 2 (should be 2), an FEve value
of 1 (should be 1), and a FDiv value of 0.714 (should be 0.714).</p>
<p>Conversely, changes of abundances on a single trait axis don’t impact
FDiv but reduce FEve (this correspond to the panel b of Figure 2):</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">l</span> <span class="op">&lt;-</span> <span class="fl">1.5</span> <span class="co"># common species</span></span>
<span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># rare species</span></span>
<span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">l</span>, <span class="va">l</span>, <span class="fl">1</span>, <span class="va">l</span>, <span class="va">l</span>, <span class="va">s</span>, <span class="va">s</span>, <span class="va">s</span>, <span class="va">s</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">wb</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">wb</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"site"</span></span></code></pre></div>
<p>We can compute weighted functional diversity indices:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fric_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">data_a</span><span class="op">)</span><span class="op">[[</span><span class="st">"FRic"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">feve_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_feve.html">fd_feve</a></span><span class="op">(</span><span class="va">data_a</span>, <span class="va">wb</span><span class="op">)</span><span class="op">[[</span><span class="st">"FEve"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fdiv_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fdiv.html">fd_fdiv</a></span><span class="op">(</span><span class="va">data_a</span>, <span class="va">wb</span><span class="op">)</span><span class="op">[[</span><span class="st">"FDiv"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fdis_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fdis.html">fd_fdis</a></span><span class="op">(</span><span class="va">data_a</span>, <span class="va">wb</span><span class="op">)</span><span class="op">[[</span><span class="st">"FDis"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">raoq_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_raoq.html">fd_raoq</a></span><span class="op">(</span><span class="va">data_a</span>, <span class="va">wb</span><span class="op">)</span><span class="op">[[</span><span class="st">"Q"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>As expected, we found an FRic value of 2 (should be 2), an FEve value
of 0.778 (should be 0.778), and a FDiv value of 0.692 (should be
0.692).</p>
</div>
<div class="section level2">
<h2 id="changes-of-coordinates-traits">Changes of coordinates (= traits)<a class="anchor" aria-label="anchor" href="#changes-of-coordinates-traits"></a>
</h2>
<p>We now change the species characteristics (i.e., the coordinates)
instead of the abundances. The changes of coordinates without changing
abundances can affect all diversity indices. If the coordinates are only
changed for species that are not on the convex hull would only affect
FEve and FDiv.</p>
<p>For example, we can change the coordinates of species to be at the
same distance of the centroid of the species, so that it doesn’t affect
the value of FDiv, but put them further away from points on the convex
hull. This would decrease FEve because species would be spaced less
evenly in the space (it corresponds to panel d of Figure 2):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shift</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span><span class="op">-</span><span class="va">shift</span>, <span class="fl">1</span><span class="op">-</span><span class="va">shift</span>,</span>
<span>  <span class="fl">1</span><span class="op">-</span><span class="va">shift</span>, <span class="fl">1</span><span class="op">+</span><span class="va">shift</span>,</span>
<span>  <span class="fl">1</span><span class="op">+</span><span class="va">shift</span>, <span class="fl">1</span><span class="op">-</span><span class="va">shift</span>,</span>
<span>  <span class="fl">1</span><span class="op">+</span><span class="va">shift</span>, <span class="fl">1</span><span class="op">+</span><span class="va">shift</span>,</span>
<span>  <span class="fl">1.00</span> , <span class="fl">0.00</span> ,</span>
<span>  <span class="fl">2.00</span> , <span class="fl">1.00</span> ,</span>
<span>  <span class="fl">1.00</span> , <span class="fl">2.00</span> ,</span>
<span>  <span class="fl">0.00</span> , <span class="fl">1.00</span> ,</span>
<span>  <span class="fl">1.00</span> , <span class="fl">1.00</span><span class="op">)</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fric_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">data_d</span><span class="op">)</span><span class="op">[[</span><span class="st">"FRic"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">feve_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_feve.html">fd_feve</a></span><span class="op">(</span><span class="va">data_d</span><span class="op">)</span><span class="op">[[</span><span class="st">"FEve"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fdiv_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fdiv.html">fd_fdiv</a></span><span class="op">(</span><span class="va">data_d</span><span class="op">)</span><span class="op">[[</span><span class="st">"FDiv"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fdis_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fdis.html">fd_fdis</a></span><span class="op">(</span><span class="va">data_d</span><span class="op">)</span><span class="op">[[</span><span class="st">"FDis"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">raoq_d</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_raoq.html">fd_raoq</a></span><span class="op">(</span><span class="va">data_d</span><span class="op">)</span><span class="op">[[</span><span class="st">"Q"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>As expected, we found an FRic value of 2 (should be 2), an FEve value
of 0.891 (should be 0.891), and a FDiv value of 0.692 (should be
0.692).</p>
<p>We can also change the coordinates of species (their traits) to only
affect FDiv and not FEve by, instead, moving species on the convex hull
while keeping their distance to other points equal. This corresponds to
the panel e Figure 2 of the paper:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_e</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0.0</span>, <span class="fl">1.0</span>,</span>
<span>  <span class="fl">0.5</span>, <span class="fl">0.5</span>,</span>
<span>  <span class="fl">1.0</span>, <span class="fl">1.0</span>,</span>
<span>  <span class="fl">1.5</span>, <span class="fl">0.5</span>,</span>
<span>  <span class="fl">2.0</span>, <span class="fl">1.0</span>,</span>
<span>  <span class="fl">1.0</span>, <span class="fl">0.0</span>,</span>
<span>  <span class="fl">0.5</span>, <span class="fl">1.5</span>,</span>
<span>  <span class="fl">1.5</span>, <span class="fl">1.5</span>,</span>
<span>  <span class="fl">1.0</span>, <span class="fl">2.0</span><span class="op">)</span>,</span>
<span>  byrow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can then compute functional diversity indices:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fric_e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fric.html">fd_fric</a></span><span class="op">(</span><span class="va">data_e</span><span class="op">)</span><span class="op">[[</span><span class="st">"FRic"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">feve_e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_feve.html">fd_feve</a></span><span class="op">(</span><span class="va">data_e</span><span class="op">)</span><span class="op">[[</span><span class="st">"FEve"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fdiv_e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fdiv.html">fd_fdiv</a></span><span class="op">(</span><span class="va">data_e</span><span class="op">)</span><span class="op">[[</span><span class="st">"FDiv"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">fdis_e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_fdis.html">fd_fdis</a></span><span class="op">(</span><span class="va">data_e</span><span class="op">)</span><span class="op">[[</span><span class="st">"FDis"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">raoq_e</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fd_raoq.html">fd_raoq</a></span><span class="op">(</span><span class="va">data_e</span><span class="op">)</span><span class="op">[[</span><span class="st">"Q"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
<p>As expected, we found an FRic value of 2 (should be 2), an FEve value
of 1 (should be 1), and a FDiv value of 0.78 (should be 0.78).</p>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Villeger_New_2008" class="csl-entry">
Villéger, Sébastien, Norman W. H. Mason, and David Mouillot. 2008.
<span>“New <span>Multidimensional Functional Diversity Indices</span>
for a <span>Multifaceted Framework</span> in <span>Functional
Ecology</span>.”</span> <em>Ecology</em> 89 (8): 2290–2301. <a href="https://doi.org/10.1890/07-1206.1" class="external-link">https://doi.org/10.1890/07-1206.1</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://rekyt.github.io/" class="external-link">Matthias Grenié</a>, <a href="https://hugogruson.fr/" class="external-link">Hugo Gruson</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
